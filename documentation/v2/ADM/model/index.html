<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">

	<title>Model - Cora Framework Documentation</title>

        <link href="../../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../../css/highlight.css">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link href="../../../../extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../../../..">Cora Framework Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../../../..">About</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Setup <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../../../setup/install/">Installation</a>
</li>

                    
                        
<li >
    <a href="../../../../setup/configuration/">Configuration</a>
</li>

                    
                        
<li >
    <a href="../../../../setup/advanced/">Advanced Configuration</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorals <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../../../tutorials/intro/">Intro to Cora</a>
</li>

                    
                        
<li >
    <a href="../../../../tutorials/composer/">Using Composer</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Docs <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">ADM ORM</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../overview/">Overview</a>
</li>

        
            
<li >
    <a href="../implementation/">Implementation</a>
</li>

        
            
<li class="active">
    <a href="./">Model</a>
</li>

        
            
<li >
    <a href="../relationships/">Model Relationships</a>
</li>

        
            
<li >
    <a href="../repository/">Repository</a>
</li>

        
            
<li >
    <a href="../gateway/">Gateway</a>
</li>

        
            
<li >
    <a href="../factory/">Factory</a>
</li>

        
            
<li >
    <a href="../lifecycle/">Lifecycle Callbacks</a>
</li>

        
            
<li >
    <a href="../database_gen/">Automated DB Creation</a>
</li>

        
            
<li >
    <a href="../opt_locking/">Optimistic Locking</a>
</li>

        
    </ul>
  </li>

                    
                        
<li >
    <a href="../../collections/">Collection Class</a>
</li>

                    
                        
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Database Class</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../databaseclass/overview/">Overview</a>
</li>

        
            
<li >
    <a href="../../databaseclass/methods_utility/">Utility Methods</a>
</li>

        
            
<li >
    <a href="../../databaseclass/methods_select/">SELECT Methods</a>
</li>

        
            
<li >
    <a href="../../databaseclass/methods_update/">UPDATE Methods</a>
</li>

        
            
<li >
    <a href="../../databaseclass/methods_insert/">INSERT Methods</a>
</li>

        
            
<li >
    <a href="../../databaseclass/methods_delete/">DELETE Methods</a>
</li>

        
            
<li >
    <a href="../../databaseclass/methods_create/">CREATE Methods</a>
</li>

        
            
<li >
    <a href="../../databaseclass/databaseresult/">DatabaseResult Class</a>
</li>

        
    </ul>
  </li>

                    
                        
<li >
    <a href="../../dependency-injection/overview/">Dependency Injection</a>
</li>

                    
                        
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Events</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../events/overview/">Overview</a>
</li>

        
            
<li >
    <a href="../../events/eventmanager/">Event Manager</a>
</li>

        
            
<li >
    <a href="../../events/eventmapping/">Event Mapping</a>
</li>

        
            
<li >
    <a href="../../events/event/">Event</a>
</li>

        
            
<li >
    <a href="../../events/listener/">Listener</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">MVC Pattern</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../mvc/overview/">Overview</a>
</li>

        
            
<li >
    <a href="../../mvc/models/">Models</a>
</li>

        
            
<li >
    <a href="../../mvc/views/">Views</a>
</li>

        
            
<li >
    <a href="../../mvc/controllers/">Controllers</a>
</li>

        
            
<li >
    <a href="../../mvc/libraries/">Libraries</a>
</li>

        
    </ul>
  </li>

                    
                        
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Routing</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../routing/overview/">Overview</a>
</li>

        
            
<li >
    <a href="../../routing/custom_routes/">Custom Routes</a>
</li>

        
    </ul>
  </li>

                    
                        
<li >
    <a href="../../validationclass/overview/">Validate Class</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">CS Topics <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../../../computerscience/computability/">Computability</a>
</li>

                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li >
                    <a rel="next" href="../implementation/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../relationships/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#model-class">Model Class</a></li>
        
    
        <li class="main "><a href="#creating-a-cora-model">Creating a Cora Model</a></li>
        
    
        <li class="main "><a href="#attributes">Attributes</a></li>
        
            <li><a href="#how-it-works">How it Works</a></li>
        
            <li><a href="#definition">Definition</a></li>
        
            <li><a href="#object-relations">Object Relations</a></li>
        
    
        <li class="main "><a href="#using-multiple-databases">Using Multiple Databases</a></li>
        
    
        <li class="main "><a href="#advanced-configuration">Advanced Configuration</a></li>
        
            <li><a href="#change-the-table-to-which-a-model-is-mapped">Change the table to which a model is mapped</a></li>
        
            <li><a href="#change-the-name-of-a-relation-table">Change the name of a relation table</a></li>
        
            <li><a href="#one-to-many-via-an-owner-column">One-to-Many via an "owner" column</a></li>
        
            <li><a href="#one-to-one-using-a-relation-table">One-to-One using a relation table</a></li>
        
            <li><a href="#namespaces">Namespaces</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="model-class">Model Class</h1>
<p>The purpose of Cora's Model class is to provide methods that allow Gateways
to examine the properties and relations of models, and to give models the knowledge
of the Repository system's existence and the Repository's responsibility for grabbing and
persisting models. This enables the ActiveRecord like features of ADM
such as dynamic loading.</p>
<h1 id="creating-a-cora-model">Creating a Cora Model</h1>
<p>To create a Cora Model, you just need to have your model extend \Cora\Model like
such:</p>
<pre><code class="php">class SomeModel extends \Cora\Model {}
</code></pre>

<p>However, to actually make your model do anything useful, you need to define your
model using some data members so that ADM knows how to use it. The core of
this definition, is the "model_attributes" array.</p>
<h1 id="attributes">Attributes</h1>
<p>tl;dr - A Cora model's attributes define the data that composes the model.</p>
<p>Normally when talking about data members for a class in PHP, the term "properties" is used.
However, since it's possible to define properties on a Cora model just like you would any
other class, "attributes" is the term I've coined to describe those model properties
that relate directly to ADM so that the two don't get confused.</p>
<p>Let's jump right in to how it works, as it's easier to describe using examples.</p>
<h2 id="how-it-works">How it Works</h2>
<p>Let's say you have a model definition that looks like the following:</p>
<pre><code class="PHP">class User extends \Cora\Model {

    // Normal properties
    // These WON'T be saved to the database.
    protected $lastAction;

    // ADM properties
    // aka the model's &quot;Attributes&quot;
    // These WILL be saved in the database.
    public $model_attributes = [
        'id' =&gt; [
            'type'          =&gt; 'int',
            'primaryKey'    =&gt; true
        ],
        'name' =&gt; [
            'type' =&gt; 'varchar'
        ],
        'email' =&gt; [
            'type' =&gt; 'varchar'
        ],
        'type'  =&gt; [
            'type' =&gt; 'varchar'
        ]
    ];

    public function __construct($name = null, $email = null, $type = null)
    {
        $this-&gt;name     = $name;
        $this-&gt;email    = $email;
        $this-&gt;type     = $type;
    }

    public function changeName($newName) {
        $this-&gt;name = $newName;
        $this-&gt;lastAction = 'Changed Name';
    }

    public function getName() {
        return $this-&gt;name;
    }

    public function getLastAction() {
        return $this-&gt;lastAction;
    }
}
</code></pre>

<p>In the example, we've defined a normal property called "lastAction" which we're
using to keep track of the last action that was performed by/on that user. However,
since we defined it as a normal property and not a model attribute, that means
the lastAction WILL NOT get saved to the database if we save the model. That's
super important to understand! You can use normal class properties, but only those
attributes defined in the $model_attributes property will be persisted (saved).
This makes the "$model_attributes" property the backbone that supports all of
ADM's functionality.</p>
<p>In terms of implementation, as can be seen in the example above, $model_attributes
is just an associative array where the key is the name of the attribute, and the
value is another associative array for defining that attribute's details. The
most basic detail which I always recommend including is that attribute's "type".
By defining this, you can use ADM's automated database creation tool.</p>
<h2 id="definition">Definition</h2>
<p>Below are the basic properties you can use to describe an attribute definition.</p>
<table>
    <tr>
        <th>Attribute Name</th>
        <th>Valid Values</th>
        <th>Description</th>
    </tr>
    <tr>
        <td>type</td>
        <td>
            <table class="unbreak">
            <tr><td>tinyint, smallint, mediumint, int, bigint</td></tr>
            <tr><td>varchar, char,</td></tr>
            <tr><td>float,</td></tr>
            <tr><td>date, datetime,</td></tr>
            <tr><td>boolean,</td></tr>
            <tr><td>binary,</td></tr>
            <tr><td>tinytext, text, mediumtext, longtext</td></tr>
            <tr><td>tinyblob, mediumblob, blob, longblob</td></tr>
            </table>
        </td>
        <td>For setting the "type" field in a DB.</td>
    </tr>
    <tr>
        <td>size</td>
        <td>{integer}</td>
        <td>The size of the field in the DB. If size is not set and the type is 'varchar', size will default to 255 when using MySQL adaptor.</td>
    </tr>
    <tr>
        <td>precision</td>
        <td>{integer}</td>
        <td>If the type is a float, this sets the places after the decimal point.</td>
    </tr>
    <tr>
        <td>primaryKey</td>
        <td>true</td>
        <td>This should only be set for ONE attribute per model.</td>
    </tr>
    <tr>
        <td>autoIncrement</td>
        <td>true</td>
        <td>Is the field auto-incrementing in value?</td>
    </tr>
    <tr>
        <td>defaultValue</td>
        <td>'Some String'</td>
        <td>
            Sets a default value for this attribute. If this value needs to be
            an object, or dynamically generated, then use the beforeCreate() lifecycle
            callback to assign a default value. See the lifecycle callbacks section
            for more info.
        </td>
    </tr>
    <tr>
        <td>enum</td>
        <td>'value1', 'value2', 'value3'</td>
        <td>The valid values if the field type is set to 'enum'.
        I don't actually recommend you use ENUM if you're starting a new project
        (it may be hard to support across various database types).
        This feature is mostly present for integration with existing projects.</td>
    </tr>
    <tr>
        <td>unique</td>
        <td>true</td>
        <td>Tells the database that the values of this attribute should be unique.</td>
    </tr>
    <tr>
        <td>index</td>
        <td>true</td>
        <td>Make an index for this attribute.</td>
    </tr>
</table>

<p>For a slightly more detailed example, let's modify our User definition from above
for the user 'type' attribute. Let's say we know we don't need 255 characters (the default)
for the type, and also we want the default user type to be just 'User'. Furthermore,
let's say we know we'll be searching a lot by email, so we want to index the email attribute:</p>
<pre><code class="PHP">public $model_attributes = [
    'id' =&gt; [
        'type'          =&gt; 'int',
        'primaryKey'    =&gt; true
    ],
    'name' =&gt; [
        'type' =&gt; 'varchar'
    ],
    'email' =&gt; [
        'type' =&gt; 'varchar',
        'index' =&gt; true
    ],
    'type'  =&gt; [
        'type' =&gt; 'varchar',
        'size' =&gt; 55,
        'defaultValue' =&gt; 'User'
    ]
];
</code></pre>

<p>Now if you generate a database using ADM's database generation tool, it will
reflect these changes.</p>
<h2 id="object-relations">Object Relations</h2>
<p>Alright, hopefully the general gist of how to define a model's attributes is becoming
clearer. An important thing we haven't addressed yet is how to setup relationships
with other objects. This is where things get exciting and Cora's ADM really shines.
Going back to our User object example, let's say a user has a Location associated
with them as well as a number of articles they've written (maybe we're running a
blogging site or something). We would setup this relationship like so:</p>
<pre><code class="php">public $model_attributes = [
    'id' =&gt; [
        'type'          =&gt; 'int',
        'primaryKey'    =&gt; true
    ],
    'name' =&gt; [
        'type' =&gt; 'varchar'
    ],
    'email' =&gt; [
        'type' =&gt; 'varchar',
        'index' =&gt; true
    ],
    'type'  =&gt; [
        'type' =&gt; 'varchar',
        'size' =&gt; 55,
        'defaultValue' =&gt; 'User'
    ],
    'location' =&gt; [
        'model' =&gt; 'location'
    ],
    'articles' =&gt; [
        'models' =&gt; 'article'
    ]
];
</code></pre>

<p>That's it! Notice the plural 's' on 'models' for referring to articles the user
has written, and the singular 'model' for representing the user's location.</p>
<p>Of course, now you may be wondering how to actually USE this, but that's equally
as intuitive and easy. Going back to the non-relational attributes like 'Type',
if you had an existing user and you wanted to change their user type from 'User'
to 'Moderator', you would do that like this:</p>
<pre><code class="php">// Grab user. 'repo' is a User repository.
$user = $this-&gt;repo-&gt;find($id);

// Change their type
$user-&gt;type = 'Moderator';

// Save the change
$repo-&gt;save($user);
</code></pre>

<p>Working with related objects is the same concept! Let's associate a new Location
and set of Articles with a user:</p>
<pre><code class="php">// Grab user:
$user = $this-&gt;repo-&gt;find($id);

// Associate a location to this user:
$user-&gt;location = new Location('Fuel Medical LLC', 'Camas', 'WA');

// Associate a set of Articles to this user:
$user-&gt;articles =   new \Cora\ResultSet([
                        new Article('How to Write Good Code'),
                        new Article('How to Unit Test')
                    ]);

// Save the changes
$repo-&gt;save($user);
</code></pre>

<p>For basic usage with a single database, that's pretty much all you need to know.
However, if you're an advanced user and will have your data spread across multiple
databases and/or you want more control over the setup of the database
(like maybe you're integrating Cora into an existing database), then read on.</p>
<h1 id="using-multiple-databases">Using Multiple Databases</h1>
<p>The database config file for Cora holds an array that let's you define multiple
database connections. If you've gone through the setup process, you've undoubtably
seen it, but here's a reminder of how this looks:</p>
<pre><code class="PHP">$dbConfig['defaultConnection'] = 'mainDb';
$dbConfig['connections'] = [
    'mainDb' =&gt; [
        'adaptor'   =&gt; 'MySQL',
        'host'      =&gt; 'localhost:3306',
        'dbName'    =&gt; 'cora',
        'dbUser'    =&gt; 'root',
        'dbPass'    =&gt; 'root'
    ],
    'secondaryDb' =&gt; [
        'adaptor'   =&gt; 'MySQL',
        'host'      =&gt; 'localhost:3306',
        'dbName'    =&gt; 'cora2',
        'dbUser'    =&gt; 'root',
        'dbPass'    =&gt; 'root'
    ],
    'mongoDb' =&gt; [
        'adaptor'   =&gt; 'MongoDb',
        'host'      =&gt; 'localhost:3306',
        'dbName'    =&gt; 'cora3',
        'dbUser'    =&gt; 'root',
        'dbPass'    =&gt; 'root'
    ]
];
</code></pre>

<p>In this config file you define the connection details for each database, tell
it what Cora database adaptor to use with that connection, and give each connection
a name.</p>
<p>In order to make use of multiple connections, you have to specify that some of your
models use a connection which is different from the default. Like so:</p>
<pre><code class="php">class Guide extends MyModel {

    public $model_connection = 'secondaryDb';
    public $model_attributes = [
        'id' =&gt; [
            'type'          =&gt; 'int',
            'primaryKey'    =&gt; true
        ],
        'title' =&gt; [
            'type' =&gt; 'varchar'
        ],
        'authors' =&gt; [
            'models' =&gt; 'user'
        ]
    ];

    public function __construct($title = null)
    {
        $this-&gt;title = $title;
    }

}
</code></pre>

<p>Now when you generate your database, the Guides table/collection will get created
using the 'secondaryDb' connection instead of the main one. Similarly, grabbing
Guide object from the DB using a repository will use this secondaryDb connection
too:</p>
<pre><code class="php">$repo = \Cora\RepositoryFactory::make('Guide');
$guide = $repo-&gt;find($id);
</code></pre>

<p>The spot where you could run into trouble is when you want a two-way reference between
objects in different databases. For example, looking at our Guide definition above
you can see we have a reference to one or more User models representing the authors
of said guide. But what if our Users model also keeps a reference to Guides a user
has been an author of? Let's add a reference to Guides in our User model:</p>
<p><em>Note: Because our User model was defined as using the default connection
(we didn't tell it to use anything different) ADM will know to fetch the authors
from the main database.</em></p>
<pre><code class="php">public $model_attributes = [
    'id' =&gt; [
        'type'          =&gt; 'int',
        'primaryKey'    =&gt; true
    ],
    'name' =&gt; [
        'type' =&gt; 'varchar'
    ],
    'email' =&gt; [
        'type' =&gt; 'varchar',
        'index' =&gt; true
    ],
    'type'  =&gt; [
        'type' =&gt; 'varchar',
        'size' =&gt; 55,
        'defaultValue' =&gt; 'User'
    ],
    'location' =&gt; [
        'model' =&gt; 'location'
    ],
    'articles' =&gt; [
        'models' =&gt; 'article'
    ],
    'guides' =&gt; [
        'models' =&gt; 'guide'
    ]
];
</code></pre>

<p>So now we have a reference to Users from a Guide, and a reference to Guides from
a User. The way these are related is by using a relation table. If you aren't
familiar with relation tables, see the image below for the general idea. Basically
it's a really simple table that holds relationships (shocking right!?). In this
screenshot, guides 9 and 10 are associated with a user who's ID is '1', and
guide 11 is associated with whoever user '2' is:</p>
<p><img alt="dynamic_pattern" src="../../../img/relation_table_example.png" /></p>
<p>The problem lies in the question of "Which database is going to hold the relation
table?" Having to maintain redundant tables on each database and then remembering
to alter both anytime a relationship changes is just plain dumb, and assuming
that the relationship will be kept in the default database didn't feel like an
assumption I could make for sure either. Thus, in order to solve this problem
I've introduced the concept of 'passive' sides in a multi-database relationship.</p>
<p>To fix our User &amp; Guide model definitions as we've defined them above, we need to
mark one side of that relationship as the 'passive' side like so:</p>
<pre><code class="php">class User extends \Cora\Model {
    public $model_attributes = [
        'id' =&gt; [
            'type'          =&gt; 'int',
            'primaryKey'    =&gt; true
        ],
        'name' =&gt; [
            'type' =&gt; 'varchar'
        ],
        'email' =&gt; [
            'type' =&gt; 'varchar',
            'index' =&gt; true
        ],
        'type'  =&gt; [
            'type' =&gt; 'varchar',
            'size' =&gt; 55,
            'defaultValue' =&gt; 'User'
        ],
        'location' =&gt; [
            'model' =&gt; 'location'
        ],
        'articles' =&gt; [
            'models' =&gt; 'article'
        ],
        'guides' =&gt; [
            'models' =&gt; 'guide',
            'passive' =&gt; true
        ]
    ];
}
</code></pre>

<p>By marking the User side of the relationship as the passive side, ADM will
now know to make the relationship table on the database represented by Guide's
connection.</p>
<h1 id="advanced-configuration">Advanced Configuration</h1>
<p>Alright, using ADM's automated database creation feature and simply setting
relationships as singular "model" or plural "models" and letting ADM handle the
rest is nice and all for new projects. But let's talk about configuration options
for incorporating ADM into a pre-existing database where you have to work within
the constraints of the existing setup.</p>
<p>First off, let's talk table names.</p>
<h2 id="change-the-table-to-which-a-model-is-mapped">Change the table to which a model is mapped</h2>
<p>By default, a table/collection name will be the plural version of the model. For
instance: our User model will be stored in a table called "users". Our Guide model
will be stored in a table called "guides" and so on and so forth. If this behavior
won't work with your existing database for a particular model, you have the option
to specify a different name.</p>
<p>Let's say you are building an internal app to be used
by your company and you want the User model to map to a table named "employees".
You would specify that like so:</p>
<pre><code class="php">class User extends \Cora\Model {

    public $model_table = 'employees';
    public $model_attributes = [
        ... stuff here ...
    ];
}
</code></pre>

<h2 id="change-the-name-of-a-relation-table">Change the name of a relation table</h2>
<p>Whenever you specify a simple plural relationship from one model to another like
so:</p>
<pre><code class="php">class User extends \Cora\Model {

    public $model_attributes = [
        'articles' =&gt; [
            'models' =&gt; 'article'
        ]
    ];
}
</code></pre>

<p>A relation table is used that is named by making the models involved plural and
appending them together with an underscore in reverse alphabetical order.
In the example above of a User associated with an Article the resulting relation
table name would be "users_articles".</p>
<p>If you're fine with the use of a relation table, but you need to change the name
of it. You can do so by utilizing the 'relTable' setting like this:</p>
<pre><code class="php">class User extends \Cora\Model {

    public $model_attributes = [
        'articles' =&gt; [
            'models' =&gt; 'article',
            'relTable' =&gt; 'some_custom_relation_table_name'
        ]
    ];
}
</code></pre>

<p>The one caveat here is that at the time of this writing, I do not support custom
column names within the relation table. The relation table column names must be
the name of the model who's ID they hold. For the above example with User and
Article, the relation table will need a 'user' column and an 'article' column. If
you have existing relation tables that don't follow this format, you'll have to change
them or else not use ADM.</p>
<h2 id="one-to-many-via-an-owner-column">One-to-Many via an "owner" column</h2>
<p>The default setup for plural relationships in ADM is the use of relation tables
just because they are the most flexible. However, if you want to force the use of
an "owner" type column in a one-to-many relationship either because it's your
personal preference or it's necessary to integrate with an existing database, ADM
makes this possible.</p>
<p>What you'll need to do is just throw a 'via' setting in with a plural model definition.
For instance, let's say we don't care about supporting multiple authors for an article
on our site, but rather just want an article to have a single owner and we want to
store a reference to this owner in the articles table via an "owner" column. We
do that like this:</p>
<pre><code class="php">class User extends \Cora\Model {
    public $model_attributes = [
        'id' =&gt; [
            'type'          =&gt; 'int',
            'primaryKey'    =&gt; true
        ],
        'name' =&gt; [
            'type' =&gt; 'varchar'
        ],
        'email' =&gt; [
            'type' =&gt; 'varchar',
            'index' =&gt; true
        ],
        'type'  =&gt; [
            'type' =&gt; 'varchar',
            'size' =&gt; 55,
            'defaultValue' =&gt; 'User'
        ],
        'location' =&gt; [
            'model' =&gt; 'location'
        ],
        'articles' =&gt; [
            'models' =&gt; 'article',
            'via'    =&gt; 'owner'
        ]
    ];
}
</code></pre>

<h2 id="one-to-one-using-a-relation-table">One-to-One using a relation table</h2>
<p>By default, one-to-one relationships are stored as a column on the model's table.
For instance, the following definition for a related Job object would be stored
as seen in the picture below:</p>
<pre><code class="php">class User extends \Cora\Model {
    public $model_attributes = [
        'id' =&gt; [
            'type'          =&gt; 'int',
            'primaryKey'    =&gt; true
        ],
        'name' =&gt; [
            'type' =&gt; 'varchar'
        ],
        'email' =&gt; [
            'type' =&gt; 'varchar',
            'index' =&gt; true
        ],
        'type'  =&gt; [
            'type' =&gt; 'varchar',
            'size' =&gt; 55,
            'defaultValue' =&gt; 'User'
        ],
        'job' =&gt; [
            'model' =&gt; 'job'
        ]
    ];
}
</code></pre>

<p><strong>"users" table:</strong> <br />
<img alt="dynamic_pattern" src="../../../img/documentation_ADM_overview_table2.png" /></p>
<p>However, if for some reason you wanted to force a single reference to use a relation
table (maybe you felt it could change to a plural relationship in the future or something),
you could do so by specifying "usesRefTable" as true:</p>
<pre><code class="php">class User extends \Cora\Model {
    public $model_attributes = [
        'id' =&gt; [
            'type'          =&gt; 'int',
            'primaryKey'    =&gt; true
        ],
        'name' =&gt; [
            'type' =&gt; 'varchar'
        ],
        'email' =&gt; [
            'type' =&gt; 'varchar',
            'index' =&gt; true
        ],
        'type'  =&gt; [
            'type' =&gt; 'varchar',
            'size' =&gt; 55,
            'defaultValue' =&gt; 'User'
        ],
        'job' =&gt; [
            'model' =&gt; 'job',
            'usesRefTable' =&gt; true
        ]
    ];
}
</code></pre>

<p>Optionally you can of course combine this with the previously talked about
"relTable" option to specify the name of the relation table if the default naming
doesn't work for you.</p>
<h2 id="namespaces">Namespaces</h2>
<p>Just a quick explanation of namespaces in the model definition...</p>
<p>When defining related models in your $model_attributes array, namespaces are
always absolute, never relative. See the namespaced Notes model below and the
relationship definition added to User for an example:</p>
<pre><code class="PHP">&lt;?php
namespace Task;

class Note extends \Note {

    public $model_table = 'notes_tasks';
    public $model_attributes = [
        'id' =&gt; [
            'type'          =&gt; 'int',
            'primaryKey'    =&gt; true
        ],
        'title' =&gt; [
            'type' =&gt; 'varchar'
        ],
        'note' =&gt; [
            'type' =&gt; 'text'
        ],
        'owner' =&gt; [
            'model' =&gt; 'user'
        ]
    ];
}
</code></pre>

<pre><code class="php">class User extends \Cora\Model {
    public $model_attributes = [
        'id' =&gt; [
            'type'          =&gt; 'int',
            'primaryKey'    =&gt; true
        ],
        'name' =&gt; [
            'type' =&gt; 'varchar'
        ],
        'email' =&gt; [
            'type' =&gt; 'varchar',
            'index' =&gt; true
        ],
        'type'  =&gt; [
            'type' =&gt; 'varchar',
            'size' =&gt; 55,
            'defaultValue' =&gt; 'User'
        ],
        'notes' =&gt; [
            'models' =&gt; 'task\\note',
            'via'    =&gt; 'owner'
        ]
    ];
}
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../../..';</script>
        <script data-main="../../../../mkdocs/js/search.js" src="../../../../mkdocs/js/require.js"></script>
        <script src="../../../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>